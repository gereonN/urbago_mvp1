# ü™¥ Beet planen - GPT-kompatibler Prompt

## √úbersicht

Dieses Dokument enth√§lt den vollst√§ndigen GPT-kompatiblen Prompt f√ºr die neue "Beet planen"-Funktion der Urbago-Anwendung. Diese Funktion erm√∂glicht es Benutzern, basierend auf ihrer Pflanzenauswahl und den Beetma√üen einen optimierten Bepflanzungsvorschlag zu erhalten.

## 1. Funktionsbeschreibung

Die "Beet planen"-Funktion verarbeitet folgende Benutzereingaben:
- Auswahl mehrerer Pflanzen aus der Datenbank (Checkbox/Symbole)
- Eingabe einer Beetgr√∂√üe in L√§nge √ó Breite (Meter)
- Klick auf Button: "Optimale Bepflanzung ermitteln"

Basierend auf diesen Eingaben generiert die Funktion einen strukturierten Vorschlag zur Beet-Bepflanzung unter Ber√ºcksichtigung von:
- Pflanzennachbarschaft (Companion Score)
- Platzbedarf (Spacing)
- Licht-/Wasserbed√ºrfnissen
- Wuchsh√∂he (z.B. Schattenwirkung)

## 2. GPT-kompatibler Prompt

```
Du bist Urbago, ein freundlicher und hilfreicher Gartenassistent f√ºr urbane G√§rtner. Deine Aufgabe ist es, einen optimalen Bepflanzungsplan f√ºr ein Gartenbeet zu erstellen.

### BENUTZEREINGABEN:

1. Ausgew√§hlte Pflanzen:
{{SELECTED_PLANTS_JSON}}

2. Beetgr√∂√üe:
- L√§nge: {{BED_LENGTH}} Meter
- Breite: {{BED_WIDTH}} Meter
- Gesamtfl√§che: {{BED_AREA}} Quadratmeter

### PFLANZENDATENBANK-AUSZUG:
{{PLANTS_DATA_JSON}}

### DEINE AUFGABE:

Erstelle einen optimalen Bepflanzungsplan f√ºr das angegebene Beet unter Ber√ºcksichtigung folgender Faktoren:

1. Pflanzenkompatibilit√§t:
   - Platziere Pflanzen mit hohem Companion Score (gute Nachbarn) nebeneinander
   - Halte Pflanzen mit negativem Companion Score (schlechte Nachbarn) voneinander fern
   - Maximiere die Gesamtkompatibilit√§t im Beet

2. Platzbedarf und Abstand:
   - Ber√ºcksichtige den ben√∂tigten Pflanzabstand jeder Pflanze
   - Stelle sicher, dass die Gesamtfl√§che des Beetes nicht √ºberschritten wird
   - Berechne die optimale Anzahl jeder Pflanze basierend auf verf√ºgbarem Platz

3. Licht- und Wasserbed√ºrfnisse:
   - Gruppiere Pflanzen mit √§hnlichen Wasserbed√ºrfnissen
   - Ber√ºcksichtige Lichtbed√ºrfnisse bei der Platzierung (z.B. h√∂here Pflanzen im Norden)
   - Schlage Bew√§sserungszonen vor, wenn n√∂tig

4. Wuchsh√∂he und Schattenwirkung:
   - Platziere h√∂here Pflanzen so, dass sie kleinere nicht beschatten
   - Nutze H√∂henunterschiede f√ºr vertikales G√§rtnern
   - Ber√ºcksichtige den Sonnenverlauf (h√∂here Pflanzen idealerweise im Norden)

### ANTWORTFORMAT:

Deine Antwort muss folgende Abschnitte enthalten:

1. üìã **√úbersicht des Bepflanzungsplans**:
   - Kurze Zusammenfassung des Plans
   - Gesamtanzahl der Pflanzen
   - Besondere Merkmale des Plans

2. üå± **Pflanzenverteilung**:
   - Tabelle mit Pflanzenname, Anzahl und ungef√§hrer Position im Beet
   - Begr√ºndung f√ºr die Platzierung jeder Pflanze
   - Optimale Pflanzzeit f√ºr jede Pflanze

3. üó∫Ô∏è **Visueller Beetplan**:
   - Textbasierte Darstellung des Beetplans (ASCII-Art oder √§hnliches)
   - Legende zur Erkl√§rung der Symbole
   - Nord-S√ºd-Ausrichtungsempfehlung

4. üíß **Pflege- und Bew√§sserungshinweise**:
   - Gruppierung nach Wasserbedarf
   - Empfehlungen zur Bew√§sserungsh√§ufigkeit
   - Hinweise zu besonderen Pflegeanforderungen

5. üåû **Saisonale Empfehlungen**:
   - Aussaat- und Pflanzkalender
   - Erntezeiten
   - Vorschl√§ge f√ºr Nachpflanzungen/Fruchtwechsel

6. üí° **Praktische Tipps f√ºr urbane G√§rtner**:
   - 3-5 spezifische Tipps f√ºr die Umsetzung des Plans
   - Hinweise zur Optimierung auf begrenztem Raum
   - M√∂gliche Herausforderungen und L√∂sungen

Formatiere deine Antwort in HTML mit <h2>, <h3>, <p>, <ul>, <li>, <table>, <tr>, <td> Tags f√ºr optimale Darstellung in der App. Verwende passende Emojis f√ºr bessere √úbersichtlichkeit.

### WICHTIGE HINWEISE:

- Falls die ausgew√§hlten Pflanzen nicht kompatibel sind, schlage Alternativen vor oder teile das Beet in separate Zonen
- Falls zu viele Pflanzen f√ºr die Beetgr√∂√üe ausgew√§hlt wurden, priorisiere basierend auf Kompatibilit√§t und optimaler Fl√§chennutzung
- Falls zu wenige Pflanzen ausgew√§hlt wurden, schlage erg√§nzende Pflanzen vor, die gut zu den ausgew√§hlten passen
- Ber√ºcksichtige die besonderen Herausforderungen urbaner G√§rten (begrenzter Platz, m√∂glicherweise eingeschr√§nkte Sonneneinstrahlung)
- Halte die Antwort praktisch, anf√§ngerfreundlich und umsetzbar
```

## 3. Beispiel f√ºr Eingabedaten

### 3.1 Beispiel f√ºr ausgew√§hlte Pflanzen (SELECTED_PLANTS_JSON)

```json
[
  {
    "plant_id": "tomato_01",
    "name_de": "Tomate",
    "name_en": "Tomato",
    "name_botanical": "Solanum lycopersicum"
  },
  {
    "plant_id": "basil_01",
    "name_de": "Basilikum",
    "name_en": "Basil",
    "name_botanical": "Ocimum basilicum"
  },
  {
    "plant_id": "carrot_01",
    "name_de": "Karotte",
    "name_en": "Carrot",
    "name_botanical": "Daucus carota"
  },
  {
    "plant_id": "lettuce_01",
    "name_de": "Salat",
    "name_en": "Lettuce",
    "name_botanical": "Lactuca sativa"
  }
]
```

### 3.2 Beispiel f√ºr Beetma√üe

```
BED_LENGTH: 2.5
BED_WIDTH: 1.2
BED_AREA: 3.0
```

### 3.3 Beispiel f√ºr Pflanzendatenbank-Auszug (PLANTS_DATA_JSON)

```json
[
  {
    "plant_id": "tomato_01",
    "name_de": "Tomate",
    "name_en": "Tomato",
    "name_botanical": "Solanum lycopersicum",
    "category": "vegetable",
    "plant_spacing": 0.5,
    "height": 1.8,
    "water_needs": "medium",
    "light_needs": "full_sun",
    "companion_score": 8,
    "good_neighbors": [
      {
        "plant_id": "basil_01",
        "benefit": "Verbessert den Geschmack und h√§lt Sch√§dlinge fern",
        "compatibility_score": 9
      },
      {
        "plant_id": "carrot_01",
        "benefit": "Lockert den Boden f√ºr Tomatenwurzeln",
        "compatibility_score": 8
      },
      {
        "plant_id": "lettuce_01",
        "benefit": "Gute Bodendecker-Kombination",
        "compatibility_score": 7
      }
    ],
    "bad_neighbors": [
      {
        "plant_id": "potato_01",
        "reason": "Erh√∂ht das Risiko von Kraut- und Knollenf√§ule",
        "compatibility_score": -8
      }
    ],
    "planting_time": "Apr-Mai",
    "harvest_time": "Jul-Okt"
  },
  {
    "plant_id": "basil_01",
    "name_de": "Basilikum",
    "name_en": "Basil",
    "name_botanical": "Ocimum basilicum",
    "category": "herb",
    "plant_spacing": 0.2,
    "height": 0.4,
    "water_needs": "medium",
    "light_needs": "full_sun",
    "companion_score": 7,
    "good_neighbors": [
      {
        "plant_id": "tomato_01",
        "benefit": "Verbessert den Geschmack und h√§lt Sch√§dlinge fern",
        "compatibility_score": 9
      }
    ],
    "bad_neighbors": [],
    "planting_time": "Mai-Jun",
    "harvest_time": "Jun-Sep"
  },
  {
    "plant_id": "carrot_01",
    "name_de": "Karotte",
    "name_en": "Carrot",
    "name_botanical": "Daucus carota",
    "category": "vegetable",
    "plant_spacing": 0.1,
    "height": 0.3,
    "water_needs": "medium",
    "light_needs": "full_sun",
    "companion_score": 6,
    "good_neighbors": [
      {
        "plant_id": "tomato_01",
        "benefit": "Tomaten sch√ºtzen vor M√∂hrenfliege",
        "compatibility_score": 8
      },
      {
        "plant_id": "lettuce_01",
        "benefit": "Gute Platznutzung durch unterschiedliche Wurzeltiefen",
        "compatibility_score": 7
      }
    ],
    "bad_neighbors": [],
    "planting_time": "M√§r-Jul",
    "harvest_time": "Jun-Okt"
  },
  {
    "plant_id": "lettuce_01",
    "name_de": "Salat",
    "name_en": "Lettuce",
    "name_botanical": "Lactuca sativa",
    "category": "vegetable",
    "plant_spacing": 0.25,
    "height": 0.2,
    "water_needs": "high",
    "light_needs": "partial_shade",
    "companion_score": 5,
    "good_neighbors": [
      {
        "plant_id": "carrot_01",
        "benefit": "Gute Platznutzung durch unterschiedliche Wurzeltiefen",
        "compatibility_score": 7
      },
      {
        "plant_id": "tomato_01",
        "benefit": "Tomaten bieten leichten Schatten f√ºr Salat",
        "compatibility_score": 7
      }
    ],
    "bad_neighbors": [],
    "planting_time": "M√§r-Aug",
    "harvest_time": "Mai-Okt"
  }
]
```

## 4. Implementierung der dynamischen Prompt-Generierung

Die folgende Python-Funktion zeigt, wie der Prompt dynamisch mit Daten aus der Datenbank und den Benutzereingaben gef√ºllt werden kann:

```python
def generate_bed_planning_prompt(selected_plant_ids, bed_length, bed_width):
    """
    Generiert einen optimierten Prompt f√ºr die Beet-Planungsfunktion
    
    Args:
        selected_plant_ids: Liste der IDs der ausgew√§hlten Pflanzen
        bed_length: L√§nge des Beetes in Metern
        bed_width: Breite des Beetes in Metern
    
    Returns:
        String: Vollst√§ndiger Prompt f√ºr die ChatGPT-API
    """
    # Berechne Beetfl√§che
    bed_area = round(bed_length * bed_width, 2)
    
    # Hole Daten der ausgew√§hlten Pflanzen
    selected_plants = []
    plants_data = []
    
    for plant_id in selected_plant_ids:
        plant_data = get_plant_data(plant_id)
        
        # Kurzversion f√ºr die Auswahlliste
        selected_plants.append({
            "plant_id": plant_id,
            "name_de": plant_data["name_de"],
            "name_en": plant_data["name_en"],
            "name_botanical": plant_data["name_botanical"]
        })
        
        # Vollst√§ndige Daten f√ºr die Planung
        plants_data.append(plant_data)
    
    # Lade Basis-Prompt-Template
    with open("templates/bed_planning_prompt.txt", "r") as f:
        prompt_template = f.read()
    
    # F√ºlle Template mit Daten
    prompt = prompt_template.replace("{{SELECTED_PLANTS_JSON}}", json.dumps(selected_plants, ensure_ascii=False, indent=2))
    prompt = prompt.replace("{{BED_LENGTH}}", str(bed_length))
    prompt = prompt.replace("{{BED_WIDTH}}", str(bed_width))
    prompt = prompt.replace("{{BED_AREA}}", str(bed_area))
    prompt = prompt.replace("{{PLANTS_DATA_JSON}}", json.dumps(plants_data, ensure_ascii=False, indent=2))
    
    return prompt
```

## 5. Beispiel f√ºr eine API-Anfrage

```python
import openai

def get_bed_planning_recommendation(selected_plant_ids, bed_length, bed_width):
    """
    Sendet eine Anfrage an die ChatGPT-API f√ºr einen Beet-Planungsvorschlag
    
    Args:
        selected_plant_ids: Liste der IDs der ausgew√§hlten Pflanzen
        bed_length: L√§nge des Beetes in Metern
        bed_width: Breite des Beetes in Metern
    
    Returns:
        String: Formatierte HTML-Antwort mit dem Bepflanzungsvorschlag
    """
    # Generiere den Prompt
    prompt = generate_bed_planning_prompt(selected_plant_ids, bed_length, bed_width)
    
    # Sende Anfrage an die API
    response = openai.ChatCompletion.create(
        model="gpt-4",
        messages=[
            {"role": "system", "content": prompt},
            {"role": "user", "content": "Erstelle einen optimalen Bepflanzungsplan f√ºr mein Beet."}
        ],
        temperature=0.7,
        max_tokens=2000
    )
    
    # Extrahiere und validiere die Antwort
    bed_plan_html = response.choices[0].message.content
    
    # Optional: HTML-Validierung und -Korrektur
    validated_html = validate_and_correct_html(bed_plan_html)
    
    return validated_html
```

## 6. Erwartetes Antwortformat

Die Antwort von ChatGPT wird in HTML formatiert sein und folgende Abschnitte enthalten:

1. **√úbersicht des Bepflanzungsplans**
2. **Pflanzenverteilung**
3. **Visueller Beetplan**
4. **Pflege- und Bew√§sserungshinweise**
5. **Saisonale Empfehlungen**
6. **Praktische Tipps f√ºr urbane G√§rtner**

Beispiel f√ºr den visuellen Beetplan (ASCII-Art):

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                  NORDEN                  ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ T     T     T     T     T     T     T   ‚îÇ
‚îÇ                                         ‚îÇ
‚îÇ B  C  B  C  B  C  B  C  B  C  B  C  B   ‚îÇ
‚îÇ                                         ‚îÇ
‚îÇ L     L     L     L     L     L     L   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                  S√úDEN                   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

Legende:
T = Tomate
B = Basilikum
C = Karotte
L = Salat
```

## 7. Fehlerbehandlung und Fallbacks

Der Prompt enth√§lt Anweisungen f√ºr verschiedene Szenarien:

1. **Inkompatible Pflanzen**: Vorschlag von Alternativen oder Aufteilung des Beetes in separate Zonen
2. **Zu viele Pflanzen**: Priorisierung basierend auf Kompatibilit√§t und optimaler Fl√§chennutzung
3. **Zu wenige Pflanzen**: Vorschlag erg√§nzender Pflanzen, die gut zu den ausgew√§hlten passen
4. **Besondere Herausforderungen urbaner G√§rten**: Ber√ºcksichtigung von begrenztem Platz und m√∂glicherweise eingeschr√§nkter Sonneneinstrahlung

## 8. Fazit

Der entwickelte GPT-kompatible Prompt f√ºr die "Beet planen"-Funktion erm√∂glicht es Benutzern, basierend auf ihrer Pflanzenauswahl und den Beetma√üen einen optimierten Bepflanzungsvorschlag zu erhalten. Der Prompt ber√ºcksichtigt Pflanzenkompatibilit√§t, Platzbedarf, Licht-/Wasserbed√ºrfnisse und Wuchsh√∂he, um einen praktischen und anf√§ngerfreundlichen Bepflanzungsplan zu erstellen.

Die Antwort wird in einem strukturierten HTML-Format mit klaren Abschnitten und visuellen Elementen pr√§sentiert, was die Benutzerfreundlichkeit erh√∂ht und die Umsetzung des Plans erleichtert.

Der Prompt ist flexibel und kann mit verschiedenen Pflanzen und Beetgr√∂√üen verwendet werden, was ihn zu einem wertvollen Werkzeug f√ºr urbane G√§rtner macht.
